version: "1.0"

defaults:
  fail_on:
    - high
  default_severity: high

datasets:
  job_market_nl.job_market_snapshot:
    domain: job_market_nl
    layer: gold
    table: job_market_snapshot
    missing_behavior: warn
    checks:
      - name: required_columns
        type: columns_exist
        columns: [period_key, sector_name, vacancies, vacancy_rate]
      - name: period_key_not_null
        type: non_null
        columns: [period_key]
        max_null_pct: 0
      - name: sector_name_not_null
        type: non_null
        columns: [sector_name]
        max_null_pct: 0

  job_market_nl.job_market_top_skills:
    domain: job_market_nl
    layer: gold
    table: job_market_top_skills
    missing_behavior: warn
    checks:
      - name: required_columns
        type: columns_exist
        columns: [skill, count]
      - name: skill_not_null
        type: non_null
        columns: [skill]
        max_null_pct: 0
      - name: count_non_negative
        type: value_range
        column: count
        min: 0
        max_invalid_pct: 0
