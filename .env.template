# Open Data Platform - Environment Configuration
# Copy this file to .env and fill in your values

# ============================================================
# Execution Mode
# ============================================================
IS_LOCAL=true
LOG_LEVEL=INFO
# Set to 'true' to use MinIO for local storage (mimics Cloud Lakehouse)
USE_MINIO=false
MINIO_ENDPOINT=http://localhost:9000
MINIO_ACCESS_KEY=change_me_minio_access_key
MINIO_SECRET_KEY=change_me_minio_secret_key

# ============================================================
# Container Runtime Secrets (required by docker-compose.yml)
# ============================================================
# Generate strong values before first run.
AIRFLOW_DB_USER=admin
AIRFLOW_DB_PASSWORD=admin
AIRFLOW_DB_NAME=airflow
AIRFLOW_FERNET_KEY=change_me_fernet_key_32_urlsafe_base64
AIRFLOW_ADMIN_USER=admin
AIRFLOW_ADMIN_PASSWORD=admin
AIRFLOW_ADMIN_EMAIL=admin@example.com

MINIO_ROOT_USER=admin
MINIO_ROOT_PASSWORD=admin

WAREHOUSE_DB=open_data_platform_dw
WAREHOUSE_USER=admin
WAREHOUSE_PASSWORD=admin
WAREHOUSE_HOST=warehouse
WAREHOUSE_PORT=5432

SUPERSET_SECRET_KEY=change_me_superset_secret_key
SUPERSET_DB_USER=admin
SUPERSET_DB_PASSWORD=admin
SUPERSET_DB_NAME=superset
SUPERSET_ADMIN_USER=admin
SUPERSET_ADMIN_PASSWORD=admin
SUPERSET_ADMIN_EMAIL=admin@superset.com

DATAHUB_MYSQL_DATABASE=datahub
DATAHUB_MYSQL_USER=admin
DATAHUB_MYSQL_PASSWORD=admin
DATAHUB_MYSQL_ROOT_PASSWORD=admin
DATAHUB_FRONTEND_SECRET=change_me_datahub_frontend_secret

# ============================================================
# Local Data Paths (used when IS_LOCAL=true)
# ============================================================
LOCAL_LAKEHOUSE_PATH=./data

# ============================================================
# Microsoft Fabric IDs (optional for local, used in Fabric)
# ============================================================
WORKSPACE_ID=local_workspace
LAKEHOUSE_BRONZE_ID=local_bronze_lakehouse
LAKEHOUSE_SILVER_ID=local_silver_lakehouse
LAKEHOUSE_GOLD_ID=local_gold_lakehouse

# ============================================================
# Azure Key Vault (used in Fabric for secrets)
# ============================================================
KEY_VAULT_URL=https://dev-kv-fabric-sales.vault.azure.net/

# ============================================================
# Observability (OSS stack)
# ============================================================
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
ALERT_TEAMS_WEBHOOK_URL=change_me_teams_webhook_url
OTEL_ENABLED=true
OTEL_SERVICE_NAMESPACE=open-data-platform
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
OTEL_METRICS_EXPORT_INTERVAL=60000

# ============================================================
# Job Market NL (optional)
# ============================================================
JOB_MARKET_USE_SPARK=false
CBS_VACANCY_RATE_TABLE=80567ENG
CBS_VACANCIES_TABLE=80472ENG
CBS_IT_SECTOR_KEY=391600
ADZUNA_APP_ID=
ADZUNA_APP_KEY=
ADZUNA_COUNTRY=nl
ADZUNA_QUERY=software engineer OR data engineer OR devops
UWV_OPEN_MATCH_URL=

# ============================================================
# Job Aggregator Connectors (RSS + Sitemap)
# ============================================================
# Enable one or more connectors (comma-separated)
JOB_CONNECTORS_ENABLED=rss,sitemap

# Compliance / ethics
# - Set a descriptive User-Agent with contact info.
# - Strongly recommended: restrict to explicitly-approved hosts you are allowed to crawl.
JOB_CONNECTORS_USER_AGENT=OpenDataPlatformJobAggregator/0.1 (contact: you@example.com)
JOB_CONNECTORS_REQUIRE_ALLOWLIST=true
JOB_CONNECTORS_ALLOWLIST_HOSTS=example.com,careers.example.org
JOB_CONNECTORS_ROBOTS_STRICT=true

# HTTP politeness / resilience
JOB_CONNECTORS_RATE_LIMIT_PER_HOST_S=1.0
JOB_CONNECTORS_TIMEOUT_CONNECT_S=10
JOB_CONNECTORS_TIMEOUT_READ_S=20
JOB_CONNECTORS_MAX_RETRIES=3
JOB_CONNECTORS_BACKOFF_BASE_S=0.5
JOB_CONNECTORS_BACKOFF_MAX_S=30
JOB_CONNECTORS_MAX_CONSECUTIVE_FAILURES=10

# Output / storage
JOB_CONNECTORS_OUTPUT_PATH=./data/job_connectors/jobs.jsonl
JOB_CONNECTORS_PERSIST_RAW=false
JOB_CONNECTORS_RAW_DIR=./data/job_connectors/raw
JOB_CONNECTORS_RAW_RETENTION_DAYS=7
JOB_CONNECTORS_REDACT_PII=true

# RSS connector
# One or more RSS/Atom feed URLs (comma-separated)
CONNECTOR_RSS_FEED_URLS=
CONNECTOR_RSS_FETCH_DETAILS=false
CONNECTOR_RSS_MAX_ITEMS_PER_FEED=200

# Sitemap connector
# One or more sitemap URLs (comma-separated). Supports sitemap indexes.
CONNECTOR_SITEMAP_URLS=
CONNECTOR_SITEMAP_FETCH_DETAILS=true
CONNECTOR_SITEMAP_MAX_URLS=1000
CONNECTOR_SITEMAP_MAX_SITEMAPS=50
# Comma-separated regex patterns to include/exclude URLs.
CONNECTOR_SITEMAP_INCLUDE_PATTERNS=jobs?,careers?,vacancies,vacature,werken-bij
CONNECTOR_SITEMAP_EXCLUDE_PATTERNS=
